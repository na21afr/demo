<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">
    <title>社員　上位20</title>
    <link rel="stylesheet" href="demo/css/handsontable.full.css">
    <link rel="stylesheet" href="demo/css/bootstrap.min.css">
    <link rel="stylesheet" href="demo/css/style.css">
    <style>
        .handsontable .htDimmed {
            background-color: #f0f0f0;
        }
        
        .handsontable thead th .relative {
            background-color: #f6bc16;
        }
		.hot-lab {
			margin: 0 auto;
		}
    </style>
</head>

<body>
    <div class="header">
        <nav class="navbar navbar-inverse">
			<div class="navbar-header">
			<!--<a class="navbar-brand" >Top 10 仕入先 (YTD)</a>-->
			</div>
		</nav>
    </div>
    <div class="container">
        <div class="mainmenu">
            <div class="panel panel-info">


                <div class="content-body">

					<ul class="nav nav-tabs">
					  <li><a href="index.html">プロジェクト</a></li>
					  <li><a href="supplier.html">仕入先</a></li>
					  <li class="active"><a href="#">社員</a></li>
					  <li><a href="budget.html">予算</a></li>
					</ul>
</br></br>
					<div class="title-menu havetext">社員　上位20</div>
</br>
                    <div>
                        <div class="form-group">
                            <select name="companyGroup" id="companyGroup" class="form-control pull-left">
								<option value="1" selected="selected">グループ全体</option>
								<option value="2">本社</option>
								<option value="3">子会社 0１</option>
								<option value="4">子会社 0２</option>
                                <option value="5">子会社 03</option>
								<option value="1">子会社 04</option>
								<option value="2">子会社 05</option>
								<option value="3">子会社 06</option>
								<option value="4">子会社 07</option>
								<option value="5">子会社 08</option>
								<option value="1">子会社 09</option>
								<option value="2">子会社 10</option>
								<option value="3">子会社 11</option>
								<option value="4">子会社 12</option>
								<option value="5">子会社 13</option>
								<option value="1">子会社 14</option>
								<option value="2">子会社 15</option>
								<option value="3">子会社 16</option>
								<option value="4">子会社 17</option>
								<option value="5">子会社 18</option>
								<option value="1">子会社 19</option>
                            </select>
</br></br></br>
							<div class="row row-no-gutters"　style="text-align: center;">
								<div class="col-xs-4" style="display: inline-block">
									<!-- Handsontable Instance 1-->
									<label>前会計年度</label>
									<div id="hot1"></div>
								</div>
								<div class="col-xs-4" style="display: inline-block">
									<!-- Handsontable Instance 2-->
									<label>現会計年度</label>
									<div id="hot2"></div>
								</div>
								<div class="col-xs-4" style="display: inline-block">
									<!-- Handsontable Instance 2-->
									<label>今月</label>
									<div id="hot3"></div>
								</div>
							</div>
                        </div>
                    </div>
                    <div class="col-sm-12">
                        <div class="title-menu notext"></div>
                    </div>
					
                    <div class="col-sm-7 footer"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- /container -->
    <script src="demo/js/jquery.min.js"></script>
    <script src="demo/js/jquery-3.3.1.js"></script>
    <script src="demo/js/jquery.serializejson.js"></script>
    <script src="demo/js/bootstrap.js"></script>
    <script src="demo/js/handsontable.full.js"></script>
	<script type="text/javascript" src="demo/json/employee.json"></script>

	<!-- This page's JS code starts here -->
    <script type="text/javascript">

		//DataSource JSON file in local
		var employeeData;

		$.getJSON('demo/json/employee.json', function(data) {
			employeeData = data;
		});

		var container1 = document.getElementById('hot1');
		var container2 = document.getElementById('hot2');
		var container3 = document.getElementById('hot3');
		var hot1;
		var hot2;
		var hot3;

		function hot1func(data){
		//Initialize Handsontable
					hot1 = new Handsontable(container1, {
					data: data,
					//stretchH: 'all',
					colWidths: [35, 100, 90, 100],
					autoWrapRow: true,
					autoRowSize: true,
					//startRows: 6,
					maxCols: 6,
					minRows: 20,
					height: 550,
					colHeaders: [
						'順位',
						'コード',
						'社員',
						'金額'
					],
					columns: [{
						data: 'rank',
						type: 'numeric',
						readOnly: true
					}, {
						data: 'code'
					}, {
						data: 'employee',
					}, {
						data: 'amount'
					}],
				});
		};

		function hot2func(data){
		//Initialize Handsontable
					hot2 = new Handsontable(container2, {
					data: data,
					//stretchH: 'all',
					colWidths: [35, 100, 90, 100],
					autoWrapRow: true,
					//autoRowSize: true,
					//startRows: 6,
					maxCols: 6,
					minRows: 10,
					height: 550,
					colHeaders: [
						'順位',
						'コード',
						'社員',
						'金額'
					],
					columns: [{
						data: 'rank',
						type: 'numeric',
						readOnly: true
					}, {
						data: 'code'
					}, {
						data: 'employee',
					}, {
						data: 'amount'
					}],
				});
		};

		function hot3func(data){
		//Initialize Handsontable
					hot3 = new Handsontable(container3, {
					data: data,
					//stretchH: 'all',
					colWidths: [35, 100, 90, 100],
					autoWrapRow: true,
					//autoRowSize: true,
					//startRows: 6,
					maxCols: 6,
					minRows: 10,
					height: 550,
					colHeaders: [
						'順位',
						'コード',
						'社員',
						'金額'
					],
					columns: [{
						data: 'rank',
						type: 'numeric',
						readOnly: true
					}, {
						data: 'code'
					}, {
						data: 'employee',
					}, {
						data: 'amount'
					}],
				});
		};

		$("#companyGroup").change(function() {
			var val = $(this).val();

			if (val == 1){
			hot1.destroy();
			hot2.destroy();
			hot3.destroy();
			hot1func(employeeData.employee3);
			hot2func(employeeData.employee9);
			hot3func(employeeData.employee6);

			} else if (val == 2){
			hot1.destroy();
			hot2.destroy();
			hot3.destroy();
			hot1func(employeeData.employee10);
			hot2func(employeeData.employee6);
			hot3func(employeeData.employee3);

			} else if (val == 3){
			hot1.destroy();
			hot2.destroy();
			hot3.destroy();
			hot1func(employeeData.employee1);
			hot2func(employeeData.employee8);
			hot3func(employeeData.employee9);

			} else if (val == 4){
			hot1.destroy();
			hot2.destroy();
			hot3.destroy();
			hot1func(employeeData.employee7);
			hot2func(employeeData.employee3);
			hot3func(employeeData.employee3);

			} else if (val == 5){
			hot1.destroy();
			hot2.destroy();
			hot3.destroy();
			hot1func(employeeData.employee8);
			hot2func(employeeData.employee10);
			hot3func(employeeData.employee1);

			}
		}); 

        $(document).ready(function() {
		hot1func(employeeData.employee3);
		hot2func(employeeData.employee9);
		hot3func(employeeData.employee6);
		
        });
    </script>
</body>

</html>